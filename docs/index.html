<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contrastive Eigen-analysis • CEA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Contrastive Eigen-analysis">
<meta property="og:description" content="More about what it does (maybe more than one line) Use four spaces when indenting paragraphs within the Description.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CEA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/CEAvignette.html">CEAvignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="cea">CEA<a class="anchor" aria-label="anchor" href="#cea"></a>
</h1></div>
<p>R package for contrastive eigen analysis.</p>
<!-- badges: start -->

<div class="section level3">
<h3 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h3>
<p>Yunhui Qi, Peng Liu, Yumou Qiu</p>
</div>
<div class="section level3">
<h3 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h3>
<p><a href="mailto:qyh@iastate.edu" class="email">qyh@iastate.edu</a> (Yunhui Qi)</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of CEA from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"yunhuiqistat/CEA"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="website">Website<a class="anchor" aria-label="anchor" href="#website"></a>
</h2>
<p>Check the vignette at <a href="https://yunhuiqistat.github.io/CEA/" class="external-link uri">https://yunhuiqistat.github.io/CEA/</a>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The goal of CEA is to conduct contrastive eigen analysis including contrastive principal component (cPCA) and its sparse version (scPCA), contrastive cross-covariance analysis (3CA) and its sparse version (3CA). (s)cPCA can be implemented by function <code>cPCA</code>. (s)3CA can be implemented by function <code>cCCA</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CEA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nanx.me/ggsci/" class="external-link">ggsci</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="cpca">cPCA<a class="anchor" aria-label="anchor" href="#cpca"></a>
</h3>
<p><code><a href="reference/eta_tuning_general.html">eta_tuning_general()</a></code></p>
<ul>
<li>
<p>Input</p>
<ul>
<li>
<code>Xt</code> data frame for target group, samples in rows, variables in columns. If PCA is applied to correlation matrix, Xt should be scaled and centered.<br>
</li>
<li>
<code>Xa</code> data frame for ancillary group, samples in rows, variables in columns. If cPCA is applied to correlation matrix, Xc should also be scaled and centered.<br>
</li>
<li>
<code>eta_range</code> a vector containing candidate eta range to be tuning from.<br>
</li>
<li>
<code>plot</code> a logical quantity indicating whether plot the ARI(nuisance) and silhouette score.<br>
</li>
<li>
<code>sparse_trt</code> parameter controlling the sparsity of target sparse PCA, if NULL, use cPCA, else use scPCA. For use of scPCA, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.<br>
</li>
<li>
<code>sparse_ctst</code> parameter controlling the sparsity of scPCA, if NULL, use cPCA, else use scPCA. For use of scPCA, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.<br>
</li>
<li>
<code>num_comps</code> if scPCA, specify the number of contrastive components that will be estimated by PMD, default is 20.</li>
<li>
<code>km_cluster</code> number showing number of nuisance clusters defined from kmeans clustering on target PCA.</li>
<li>
<code>ckm_cluster</code> number of interesting clusters defined from kmeans clustering on cPCA/scPCA.</li>
</ul>
</li>
<li>
<p>Output</p>
<ul>
<li>A list containing selected value of <span class="math inline"><em>η</em></span> <code>eta_opt</code>, the vector of ARI(nuisance) <code>nuisance_ARI</code> and the vector of Silhouette <code>silhouette</code>, and the ggplot object <code>p</code>.</li>
</ul>
</li>
</ul>
<p><code><a href="reference/cPCA.html">cPCA()</a></code></p>
<ul>
<li>
<p>Input</p>
<ul>
<li>
<code>Xt</code> data frame for target group, samples in rows, variables in columns.</li>
<li>
<code>Xa</code> data frame for ancillary group, samples in rows, variables in columns.</li>
<li>
<code>eta</code> tuning parameter controlling how much ancillary variation should be contrasted off from the target variation. It can be theo <code>eta_opt</code> from function eta_tuning().</li>
<li>
<code>sparse_ctst</code> parameter controlling the sparsity of scPCA, if NULL, use cPCA, else use scPCA. For use of scPCA, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.<br>
</li>
<li>
<code>sparse_trt</code> parameter controlling the sparsity of target sparse PCA, if NULL, use cPCA, else use scPCA. For use of scPCA, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.<br>
</li>
<li>
<code>sparse_ctrl</code> parameter controlling the sparsity of ancillary sparse PCA, if NULL, use cPCA, else use scPCA. For use of scPCA, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.</li>
</ul>
</li>
<li>
<p>Output</p>
<ul>
<li>A list containing contrastive scores <code>cPC</code> and loadings <code>cU</code>, target scores <code>PCt</code> and loadings <code>Ut</code>, and ancillary scores <code>PCa</code> and loadings <code>Ua</code>.</li>
</ul>
</li>
</ul>
<ol style="list-style-type: decimal">
<li>We load the simulated data from the <code>data(intro)</code>, and use <code>eta_tuning()</code> to get optimal value of tuning parameter <span class="math inline"><em>η</em></span>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eta_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">5</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">eta_opt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/eta_tuning_general.html">eta_tuning_general</a></span><span class="op">(</span>Xt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cPCA</span><span class="op">$</span><span class="va">Xt</span>, Xa <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cPCA</span><span class="op">$</span><span class="va">Xa</span>, eta_range <span class="op">=</span> <span class="va">eta_range</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, sparse_trt <span class="op">=</span> <span class="cn">NULL</span>, sparse_ctst <span class="op">=</span> <span class="cn">NULL</span>, num_comps <span class="op">=</span> <span class="fl">20</span>, km_cluster <span class="op">=</span> <span class="fl">2</span>, ckm_cluster <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">eta_opt</span></span></code></pre></div>
<p><img src="reference/figures/README-eta%20tuning%20for%20cPCA-1.png" style="display: block; margin: auto;"></p>
<ol start="2" style="list-style-type: decimal">
<li>We then input the data and the resulting <span class="math inline"><em>η</em></span> value to cPCA.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># speccify sparsity parameters to be NULL for cPCA</span></span>
<span><span class="va">cpca_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cPCA.html">cPCA</a></span><span class="op">(</span>Xt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cPCA</span><span class="op">$</span><span class="va">Xt</span>, Xa <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cPCA</span><span class="op">$</span><span class="va">Xa</span>, eta <span class="op">=</span> <span class="va">eta_opt</span>, sparse_ctst <span class="op">=</span> <span class="cn">NULL</span>, sparse_trt <span class="op">=</span> <span class="cn">NULL</span>, sparse_ctrl <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>We get the score plot of cPCA. In comparison, we also get the score plot of target PCA. Here, as in the paper, we have nuisance subgroup factor <span class="math inline"><em>C</em></span> and interesting subgroup factor <span class="math inline"><em>B</em></span>. In the score plot, we see the first target score is associated with the nuisance subgroups, while the first contrastive score is associated with the interesting subgroups. This validates the removal of nuisance effect and discovery of hidden subgroups by cPCA.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cPC1 <span class="op">=</span> <span class="va">cpca_res</span><span class="op">$</span><span class="va">cPC</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, cPC2 <span class="op">=</span> <span class="va">cpca_res</span><span class="op">$</span><span class="va">cPC</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                        PC1 <span class="op">=</span> <span class="va">cpca_res</span><span class="op">$</span><span class="va">PCt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, PC2 <span class="op">=</span> <span class="va">cpca_res</span><span class="op">$</span><span class="va">PCt</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                        <span class="va">intro</span><span class="op">$</span><span class="va">cPCA</span><span class="op">$</span><span class="va">covariates_t</span><span class="op">)</span></span>
<span><span class="va">cP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cPC1</span>, y <span class="op">=</span> <span class="va">cPC2</span>, color <span class="op">=</span> <span class="va">B</span>, shape <span class="op">=</span> <span class="va">C</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Contrastive"</span>, color <span class="op">=</span> <span class="st">"Interesting \n subgroups"</span>, shape <span class="op">=</span> <span class="st">"Nuisance \nsubgroups"</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>              axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>              axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span>, y<span class="op">=</span><span class="va">PC2</span>, color<span class="op">=</span> <span class="va">B</span>, shape <span class="op">=</span> <span class="va">C</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Target"</span>, color <span class="op">=</span> <span class="st">"Interesting \n subgroups"</span>, shape <span class="op">=</span> <span class="st">"Nuisance \nsubgroups"</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>              axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>              axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">Pt</span>,<span class="va">cP</span>, nrow <span class="op">=</span> <span class="fl">1</span>, common.legend <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="st">"bottom"</span>, align <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_score</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-cPCA%20usage%20score%20plot-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="scpca">scPCA<a class="anchor" aria-label="anchor" href="#scpca"></a>
</h3>
<p>To illustrate the use of function <code><a href="reference/cPCA.html">cPCA()</a></code> for sparse cPCA, we use the barley expression data example. For details of data processing and references, please refer to <code>data(barley)</code>.</p>
<ol style="list-style-type: decimal">
<li>We load the processed data from the <code>data(intro)</code>, and use assigned <span class="math inline"><em>η</em> = 1</span>, we also specify the sparsity parameters to be 0.3.</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span></span>
<span><span class="co"># specify the sparsity parameters for scPCA</span></span>
<span><span class="va">scPCA_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cPCA.html">cPCA</a></span><span class="op">(</span>Xt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">Xt</span>, Xa <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">Xa</span>, eta <span class="op">=</span> <span class="fl">1</span>, sparse_ctst <span class="op">=</span> <span class="fl">0.3</span>, sparse_trt <span class="op">=</span> <span class="fl">0.3</span>, sparse_ctrl <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>We get the score plot of scPCA. In comparison, we also get the score plot of target PCA. As seen from the figure, Genotype effect is removed by scPCA, and the fungus subgroups is revealed by the first scPCA score.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PCt</span> <span class="op">&lt;-</span> <span class="va">scPCA_res</span><span class="op">$</span><span class="va">PCt</span></span>
<span><span class="va">PCa</span> <span class="op">&lt;-</span> <span class="va">scPCA_res</span><span class="op">$</span><span class="va">PCa</span></span>
<span><span class="va">cPC</span> <span class="op">&lt;-</span> <span class="va">scPCA_res</span><span class="op">$</span><span class="va">cPC</span></span>
<span><span class="va">Ut</span> <span class="op">&lt;-</span> <span class="va">scPCA_res</span><span class="op">$</span><span class="va">Ut</span></span>
<span><span class="va">Ua</span> <span class="op">&lt;-</span> <span class="va">scPCA_res</span><span class="op">$</span><span class="va">Ua</span></span>
<span><span class="va">cU</span> <span class="op">&lt;-</span> <span class="va">scPCA_res</span><span class="op">$</span><span class="va">cU</span></span>
<span></span>
<span><span class="va">plot_data_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cPC1 <span class="op">=</span> <span class="va">cPC</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, cPC2 <span class="op">=</span> <span class="va">cPC</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                          PC1 <span class="op">=</span> <span class="va">PCt</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, PC2 <span class="op">=</span> <span class="va">PCt</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                          Genotype <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_t</span><span class="op">$</span><span class="va">Genotype</span>,</span>
<span>                          Isolate <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_t</span><span class="op">$</span><span class="va">Isolate</span>,</span>
<span>                          Time_bi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_t</span><span class="op">$</span><span class="va">Time_bi</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Early"</span>,<span class="st">"Late"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plot_data_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>PC1 <span class="op">=</span> <span class="va">PCa</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, PC2 <span class="op">=</span> <span class="va">PCa</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, </span>
<span>                          Genotype <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_a</span><span class="op">$</span><span class="va">Genotype</span>,</span>
<span>                          Isolate <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_a</span><span class="op">$</span><span class="va">Isolate</span>,</span>
<span>                          Time <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_a</span><span class="op">$</span><span class="va">Time</span>,</span>
<span>                          Time_bi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">intro</span><span class="op">$</span><span class="va">scPCA</span><span class="op">$</span><span class="va">covariates_a</span><span class="op">$</span><span class="va">Time_bi</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Early"</span>,<span class="st">"Late"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data_t</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cPC1</span>, y <span class="op">=</span> <span class="va">cPC2</span>, color <span class="op">=</span> <span class="va">Isolate</span>, shape <span class="op">=</span> <span class="va">Genotype</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Contrastive"</span>, color <span class="op">=</span> <span class="st">"Fungus"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://nanx.me/ggsci/reference/scale_d3.html" class="external-link">scale_color_d3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Pt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data_t</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span>, y<span class="op">=</span><span class="va">PC2</span>, color<span class="op">=</span> <span class="va">Isolate</span>, shape <span class="op">=</span> <span class="va">Genotype</span> <span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Late"</span>, color <span class="op">=</span> <span class="st">"Fungus"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://nanx.me/ggsci/reference/scale_d3.html" class="external-link">scale_color_d3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">Pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data_a</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">PC1</span>, y<span class="op">=</span><span class="va">PC2</span>, color<span class="op">=</span> <span class="va">Isolate</span>, shape <span class="op">=</span> <span class="va">Genotype</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Early"</span>, color <span class="op">=</span> <span class="st">"Fungus"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://nanx.me/ggsci/reference/scale_d3.html" class="external-link">scale_color_d3</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">Pa</span>, <span class="va">Pt</span>, <span class="va">cP</span>,  nrow<span class="op">=</span><span class="fl">1</span>, ncol<span class="op">=</span><span class="fl">3</span>,  common.legend <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_score</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-scPCA%20usage%20score%20plot-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="id_3ca">3CA<a class="anchor" aria-label="anchor" href="#id_3ca"></a>
</h3>
<p><code><a href="reference/cCCA.html">cCCA()</a></code></p>
<ul>
<li>
<p>Input</p>
<ul>
<li>
<code>Xt</code> data frame for one data type in target group, samples in rows, variables in columns. To conduct analysis based on cross corrlation matrix, each feature should be centered and standardized.<br>
</li>
<li>
<code>Xa</code> data frame for one data type in ancillary group, samples in rows, variables in columns. To conduct analysis based on cross corrlation matrix, each feature should be centered and standardized.<br>
</li>
<li>
<code>Yt</code> data frame for another data type in target group, samples in rows, variables in columns. To conduct analysis based on cross corrlation matrix, each feature should be centered and standardized.<br>
</li>
<li>
<code>Ya</code> data frame for another data type in ancillary group, samples in rows, variables in columns. To conduct analysis based on cross corrlation matrix, each feature should be centered and standardized.<br>
</li>
<li>
<code>eta</code> tuning parameter controlling how much ancillary variation should be contrasted off from the target variation. If NULL, the estimated eta introduced in paper will be used.</li>
<li>
<code>sparse_ctst</code> parameter controlling the sparsity of s3CA, if NULL, use 3CA, else use s3CA. For use of s3CA, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.<br>
</li>
<li>
<code>sparse_trt</code> parameter controlling the sparsity of target sparse cross covariance/correlation analysis, if NULL, use cross covariance/correlation analysis, else use sparse cross covariance/correlation analysis. For use of sparse version, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.<br>
</li>
<li>
<code>sparse_ctrl</code> parameter controlling the sparsity of ancillary sparse cross covariance/correlation analysis, if NULL, use cross covariance/correlation analysis, else use sparse cross covariance/correlation analysis. For use of sparse version, if vector, refer sumabss in PMD.cv from package PMA, if single number, refer sumabs in PMD in package PMA.</li>
</ul>
</li>
<li>
<p>Output</p>
<ul>
<li>A list containing contrastive SVD object <code>CCA_ctst</code> including singular values <code>d</code>, loadings for X <code>u</code>, loadings for Y <code>v</code>; target only SVD object <code>CCA_trt</code> and ancillary only SVD object <code>CCA_ctrl</code>.</li>
</ul>
</li>
</ul>
<ol style="list-style-type: decimal">
<li>We load the simulated data from the <code>data(intro)</code>, and get the top estimated latent factor (score) from 3CA. As in the paper, we also simulated the external continuous response from linear model using the target population latent factor with coefficient 1.5. Here we conduct 3CA and get the estimated top latent factor and regress the response on the score to recover the coefficient.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_3CA</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cCCA.html">cCCA</a></span><span class="op">(</span>Xa <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cCCA</span><span class="op">$</span><span class="va">Xa</span>, Ya <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cCCA</span><span class="op">$</span><span class="va">Ya</span>, </span>
<span>                Xt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cCCA</span><span class="op">$</span><span class="va">Xt</span>, Yt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">cCCA</span><span class="op">$</span><span class="va">Yt</span>, eta  <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                sparse_ctst <span class="op">=</span> <span class="cn">NULL</span>, sparse_trt <span class="op">=</span> <span class="cn">NULL</span>, sparse_ctrl <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  optimal eta is 3.14944030744854</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>The coefficient 1.5 is recovered by the estimated score from 3CA, validating that the target latent factor is estimated by 3CA.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">intro</span><span class="op">$</span><span class="va">cCCA</span><span class="op">$</span><span class="va">response</span> <span class="op">~</span> <span class="va">intro</span><span class="op">$</span><span class="va">cCCA</span><span class="op">$</span><span class="va">Xt</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">res_3CA</span><span class="op">$</span><span class="va">CCA_ctst</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; intro$cCCA$Xt %*% res_3CA$CCA_ctst$u[, 1] </span></span>
<span><span class="co">#&gt;                                  1.506891</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="s3ca">s3CA<a class="anchor" aria-label="anchor" href="#s3ca"></a>
</h3>
<p>To illustrate the use of function <code>s3CA()</code> for sparse 3CA, we use the covid metabolome and proteome data example. For details of data processing and references, please refer to the paper and <code>data(covid)</code>.</p>
<ol style="list-style-type: decimal">
<li>We load the processed data from the <code>data(intro)</code>, and use assigned <span class="math inline"><em>η</em> = 1</span>, we also specify the sparsity parameters range to use cross validation to select the sparsity parameters. s3CA is implemented to get the score plot.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s3CA_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cCCA.html">cCCA</a></span><span class="op">(</span>Xa <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Xa</span>, Ya <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Ya</span>, </span>
<span>                 Xt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Xt</span>, Yt <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Yt</span>, eta  <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                 sparse_ctst <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="fl">20</span><span class="op">)</span>, </span>
<span>                 sparse_trt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="fl">40</span><span class="op">)</span>, </span>
<span>                 sparse_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use provided eta value.</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>We get the score plot from s3CA. In comparison, we also get the score plot of covid group and non-covid group cross-covariance analysis respectively. As described in the paper, ICU effect is removed by contrasting, and the estimated top latent factor by s3CA is associated with the external continuous variable - platelet counts.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CCA_ctst</span> <span class="op">&lt;-</span> <span class="va">s3CA_res</span><span class="op">$</span><span class="va">CCA_ctst</span></span>
<span><span class="va">CCA_ctrl</span> <span class="op">&lt;-</span> <span class="va">s3CA_res</span><span class="op">$</span><span class="va">CCA_ctrl</span></span>
<span><span class="va">CCA_trt</span> <span class="op">&lt;-</span> <span class="va">s3CA_res</span><span class="op">$</span><span class="va">CCA_trt</span></span>
<span></span>
<span></span>
<span><span class="va">df_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cCCX <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Xt</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">CCA_ctst</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                       cCCY <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Yt</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">CCA_ctst</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                       <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">covariates_t</span><span class="op">)</span></span>
<span><span class="va">df_score_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CCtX <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Xt</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">CCA_trt</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                         CCtY <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Yt</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">CCA_trt</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                         <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">covariates_t</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_score_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CCcX <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Xa</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">CCA_ctrl</span><span class="op">$</span><span class="va">u</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                         CCcY <span class="op">=</span> <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">Ya</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">CCA_ctrl</span><span class="op">$</span><span class="va">v</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                         <span class="va">intro</span><span class="op">$</span><span class="va">s3CA</span><span class="op">$</span><span class="va">covariates_a</span><span class="op">)</span></span>
<span></span>
<span><span class="va">interested_y</span> <span class="op">&lt;-</span> <span class="st">"Platelet_K.uL"</span></span>
<span><span class="va">p_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df_score</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cCCY"</span>,<span class="st">"icu"</span>,<span class="va">interested_y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"cCCY"</span>,y <span class="op">=</span> <span class="va">interested_y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"icu"</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Contrastive"</span>, x <span class="op">=</span> <span class="st">"Yv"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://nanx.me/ggsci/reference/scale_d3.html" class="external-link">scale_color_d3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p_reg_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df_score_t</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCtY"</span>, <span class="st">"icu"</span>,<span class="va">interested_y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"CCtY"</span>,y <span class="op">=</span> <span class="va">interested_y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"icu"</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"COVID"</span>, x <span class="op">=</span> <span class="st">"Yv"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://nanx.me/ggsci/reference/scale_d3.html" class="external-link">scale_color_d3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p_reg_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">df_score_a</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCcY"</span>, <span class="st">"icu"</span>,<span class="va">interested_y</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"CCcY"</span>,y <span class="op">=</span> <span class="va">interested_y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_.html" class="external-link">aes_string</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"icu"</span> <span class="op">)</span><span class="op">)</span><span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Non COVID"</span>, x <span class="op">=</span> <span class="st">"Yv"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,  <span class="co"># Adjust text size</span></span>
<span>        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,  <span class="co"># Adjust axis title size</span></span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://nanx.me/ggsci/reference/scale_d3.html" class="external-link">scale_color_d3</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_score</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span><span class="va">p_reg_t</span>, <span class="va">p_reg_a</span>, <span class="va">p_reg</span>, common.legend <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                     legend <span class="op">=</span> <span class="st">"bottom"</span>, nrow<span class="op">=</span><span class="fl">1</span>, align <span class="op">=</span> <span class="st">"hv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p_score</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-s3CA%20usage%20score%20plot-1.png" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CEA</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yunhui Qi <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://opensource.org/licenses/MIT" class="external-link"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Yunhui Qi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
